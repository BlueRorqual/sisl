

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Specifying super-cell information &mdash; sisl |release| documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="sisl |release| documentation" href="../index.html"/>
        <link rel="up" title="Tutorials" href="../tutorials.html"/>
        <link rel="next" title="Electronic structure setup – part 1" href="tutorial_05.html"/>
        <link rel="prev" title="Geometry creation – part 2" href="tutorial_02.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> sisl
          

          
          </a>

          
            
            
              <div class="version">
                0.8.5-213
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/scripts.html">Scripts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial_01.html">Geometry creation -- part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_02.html">Geometry creation -- part 2</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Supercells</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-square">Example – square</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-graphene">Example – graphene</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_05.html">Electronic structure setup -- part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_06.html">Electronic structure setup -- part 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst/files.html">File formats</a></li>
</ul>

            
          
    <a href="py-modindex.html">API documentation</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sisl</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Specifying super-cell information</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/tutorial_04.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="specifying-super-cell-information">
<span id="tutorial-04"></span><h1>Specifying super-cell information<a class="headerlink" href="#specifying-super-cell-information" title="Permalink to this headline">¶</a></h1>
<p>An important thing when dealing with geometries in how the <em>super-cell</em> is
used. First, recall that the number of supercells can be retrieved by:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>
<span class="go">{na: 1, no: 1, species:</span>
<span class="go"> {Atoms(1):</span>
<span class="go">    (1) == [H, Z: 1, orbs: 1, mass(au): 1.00794, maxR: -1.00000],</span>
<span class="go"> },</span>
<span class="go"> nsc: [1, 1, 1], maxR: -1.0</span>
<span class="go">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">nsc</span> <span class="c1"># or geometry.sc.nsc</span>
<span class="go">array([1, 1, 1], dtype=int32)</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">nsc</span></code> is the specific super-cell information. In the default
case only the unit-cell is taken into consideration (<code class="docutils literal"><span class="pre">nsc:</span> <span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1]</span></code>). However when using
the <a class="reference internal" href="../sisl/sisl.geometry.html#sisl.geometry.Geometry.close" title="sisl.geometry.Geometry.close"><code class="xref any py py-meth docutils literal"><span class="pre">Geometry.close</span></code></a> or <a class="reference internal" href="../sisl/sisl.geometry.html#sisl.geometry.Geometry.within" title="sisl.geometry.Geometry.within"><code class="xref any py py-meth docutils literal"><span class="pre">Geometry.within</span></code></a> functions one may retrieve neighbouring atoms
depending on the size of the supercell.</p>
<p>Specifying the number of super-cells may be done when creating the geometry,
or after it has been created:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">sc</span><span class="o">=</span><span class="n">SuperCell</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">nsc</span>
<span class="go">array([3, 3, 3], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">set_nsc</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">nsc</span>
<span class="go">array([3, 1, 5], dtype=int32)</span>
</pre></div>
</div>
<p>The final geometry enables intrinsic routines to interact with the 2 closest neighbouring cells
along the first lattice vector (<code class="docutils literal"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">==</span> <span class="pre">3</span></code>), and the 4 closest neighbouring cells
along the third lattice vector (<code class="docutils literal"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">==</span> <span class="pre">5</span></code>). Note that the number of neighbouring supercells
is <em>always</em> an uneven number because if it connects in the positive direction it also connects
in the negative, hence the primary unit-cell plus 2 per neighbouring cell.</p>
<div class="section" id="example-square">
<h2>Example – square<a class="headerlink" href="#example-square" title="Permalink to this headline">¶</a></h2>
<p>Here we show a square 2D lattice with one atom in the unit-cell and a supercell
which extends 2 cells along the Cartesian <span class="math">\(x\)</span> lattice vector (5 in total) and 1
cell along the Cartesian <span class="math">\(y\)</span> lattice vector (3 in total):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">square</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">sc</span><span class="o">=</span><span class="n">SuperCell</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>which results in this underlying geometry:</p>
<a class="reference internal image-reference" href="../_images/04_supercell.png"><img alt="../_images/04_supercell.png" class="align-center" src="../_images/04_supercell.png" style="width: 200pt;" /></a>
<p>With this setup, sisl, can handle couplings that are within the defined supercell
structure, see green, full arrow. Any other couplings that reach farther than the
specified supercell cannot be defined (and will thus <em>always</em> be zero), see the
red, dashed arrow.</p>
<p>Note that even though the geometry is purely 2D, sisl <strong>requires</strong> the last non-used
dimension. For 2D cases the non-used direction should <em>always</em> have a supercell of 1.</p>
</div>
<div class="section" id="example-graphene">
<h2>Example – graphene<a class="headerlink" href="#example-graphene" title="Permalink to this headline">¶</a></h2>
<p>A commonly encountered example is the graphene unit-cell. In a tight-binding picture
one may suffice with a nearest-neighbour coupling.</p>
<p>Here we create the simple graphene 2D lattice with 2 atoms per unit-cell and
a supercell of <code class="docutils literal"><span class="pre">[3,</span> <span class="pre">3,</span> <span class="pre">1]</span></code> to account for nearest neighbour couplings.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graphene</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">graphene</span><span class="p">()</span>
</pre></div>
</div>
<p>which results in this underlying geometry:</p>
<a class="reference internal image-reference" href="../_images/04_graphene_couplings.png" id="graphene-couplings"><img alt="../_images/04_graphene_couplings.png" class="align-center" id="graphene-couplings" src="../_images/04_graphene_couplings.png" style="width: 200pt;" /></a>
<p>The couplings from each unit-cell atom is highlighted by green (first atom) and
blue (second atom) arrows. When dealing with Hamiltonians the supercell is extremely
important to obtain the correct electronic structure. If one wishes to use the 3rd
nearest neighbour couplings one is forced to use a supercell of <code class="docutils literal"><span class="pre">[5,</span> <span class="pre">5,</span> <span class="pre">1]</span></code> (please
try and convince yourself of this).</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial_05.html" class="btn btn-neutral float-right" title="Electronic structure setup – part 1" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorial_02.html" class="btn btn-neutral" title="Geometry creation – part 2" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2017, Nick R. Papior.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.8.5-213',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>