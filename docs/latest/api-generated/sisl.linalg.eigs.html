

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>eigs &mdash; sisl |release| documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="sisl |release| documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> sisl
          

          
          </a>

          
            
            
              <div class="version">
                0.9.2-166
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">Other resources</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst/files.html">File formats</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sisl</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>eigs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api-generated/sisl.linalg.eigs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="eigs">
<h1>eigs<a class="headerlink" href="#eigs" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="sisl.linalg.eigs">
<code class="descclassname">sisl.linalg.</code><code class="descname">eigs</code><span class="sig-paren">(</span><em>A</em>, <em>k=6</em>, <em>M=None</em>, <em>sigma=None</em>, <em>which='LM'</em>, <em>v0=None</em>, <em>ncv=None</em>, <em>maxiter=None</em>, <em>tol=0</em>, <em>return_eigenvectors=True</em>, <em>Minv=None</em>, <em>OPinv=None</em>, <em>OPpart=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scipy/sparse/linalg/eigen/arpack/arpack.html#eigs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.linalg.eigs" title="Permalink to this definition">¶</a></dt>
<dd><p>Find k eigenvalues and eigenvectors of the square matrix A.</p>
<p>Solves <code class="docutils literal"><span class="pre">A</span> <span class="pre">*</span> <span class="pre">x[i]</span> <span class="pre">=</span> <span class="pre">w[i]</span> <span class="pre">*</span> <span class="pre">x[i]</span></code>, the standard eigenvalue problem
for w[i] eigenvalues with corresponding eigenvectors x[i].</p>
<p>If M is specified, solves <code class="docutils literal"><span class="pre">A</span> <span class="pre">*</span> <span class="pre">x[i]</span> <span class="pre">=</span> <span class="pre">w[i]</span> <span class="pre">*</span> <span class="pre">M</span> <span class="pre">*</span> <span class="pre">x[i]</span></code>, the
generalized eigenvalue problem for w[i] eigenvalues
with corresponding eigenvectors x[i]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>A</strong> : ndarray, sparse matrix or LinearOperator</p>
<blockquote>
<div><p>An array, sparse matrix, or LinearOperator representing
the operation <code class="docutils literal"><span class="pre">A</span> <span class="pre">*</span> <span class="pre">x</span></code>, where A is a real or complex square matrix.</p>
</div></blockquote>
<p><strong>k</strong> : int, optional</p>
<blockquote>
<div><p>The number of eigenvalues and eigenvectors desired.
<em class="xref py py-obj">k</em> must be smaller than N-1. It is not possible to compute all
eigenvectors of a matrix.</p>
</div></blockquote>
<p><strong>M</strong> : ndarray, sparse matrix or LinearOperator, optional</p>
<blockquote>
<div><p>An array, sparse matrix, or LinearOperator representing
the operation M*x for the generalized eigenvalue problem</p>
<blockquote>
<div><p>A * x = w * M * x.</p>
</div></blockquote>
<p>M must represent a real, symmetric matrix if A is real, and must
represent a complex, hermitian matrix if A is complex. For best
results, the data type of M should be the same as that of A.
Additionally:</p>
<blockquote>
<div><p>If <em class="xref py py-obj">sigma</em> is None, M is positive definite</p>
<p>If sigma is specified, M is positive semi-definite</p>
</div></blockquote>
<p>If sigma is None, eigs requires an operator to compute the solution
of the linear equation <code class="docutils literal"><span class="pre">M</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">b</span></code>.  This is done internally via a
(sparse) LU decomposition for an explicit matrix M, or via an
iterative solver for a general linear operator.  Alternatively,
the user can supply the matrix or operator Minv, which gives
<code class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">Minv</span> <span class="pre">*</span> <span class="pre">b</span> <span class="pre">=</span> <span class="pre">M^-1</span> <span class="pre">*</span> <span class="pre">b</span></code>.</p>
</div></blockquote>
<p><strong>sigma</strong> : real or complex, optional</p>
<blockquote>
<div><p>Find eigenvalues near sigma using shift-invert mode.  This requires
an operator to compute the solution of the linear system
<code class="docutils literal"><span class="pre">[A</span> <span class="pre">-</span> <span class="pre">sigma</span> <span class="pre">*</span> <span class="pre">M]</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">b</span></code>, where M is the identity matrix if
unspecified. This is computed internally via a (sparse) LU
decomposition for explicit matrices A &amp; M, or via an iterative
solver if either A or M is a general linear operator.
Alternatively, the user can supply the matrix or operator OPinv,
which gives <code class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">OPinv</span> <span class="pre">*</span> <span class="pre">b</span> <span class="pre">=</span> <span class="pre">[A</span> <span class="pre">-</span> <span class="pre">sigma</span> <span class="pre">*</span> <span class="pre">M]^-1</span> <span class="pre">*</span> <span class="pre">b</span></code>.
For a real matrix A, shift-invert can either be done in imaginary
mode or real mode, specified by the parameter OPpart (‘r’ or ‘i’).
Note that when sigma is specified, the keyword ‘which’ (below)
refers to the shifted eigenvalues <code class="docutils literal"><span class="pre">w'[i]</span></code> where:</p>
<blockquote>
<div><dl class="docutils">
<dt>If A is real and OPpart == ‘r’ (default),</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">w'[i]</span> <span class="pre">=</span> <span class="pre">1/2</span> <span class="pre">*</span> <span class="pre">[1/(w[i]-sigma)</span> <span class="pre">+</span> <span class="pre">1/(w[i]-conj(sigma))]</span></code>.</p>
</dd>
<dt>If A is real and OPpart == ‘i’,</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">w'[i]</span> <span class="pre">=</span> <span class="pre">1/2i</span> <span class="pre">*</span> <span class="pre">[1/(w[i]-sigma)</span> <span class="pre">-</span> <span class="pre">1/(w[i]-conj(sigma))]</span></code>.</p>
</dd>
</dl>
<p>If A is complex, <code class="docutils literal"><span class="pre">w'[i]</span> <span class="pre">=</span> <span class="pre">1/(w[i]-sigma)</span></code>.</p>
</div></blockquote>
</div></blockquote>
<p><strong>v0</strong> : ndarray, optional</p>
<blockquote>
<div><p>Starting vector for iteration.
Default: random</p>
</div></blockquote>
<p><strong>ncv</strong> : int, optional</p>
<blockquote>
<div><p>The number of Lanczos vectors generated
<em class="xref py py-obj">ncv</em> must be greater than <em class="xref py py-obj">k</em>; it is recommended that <code class="docutils literal"><span class="pre">ncv</span> <span class="pre">&gt;</span> <span class="pre">2*k</span></code>.
Default: <code class="docutils literal"><span class="pre">min(n,</span> <span class="pre">max(2*k</span> <span class="pre">+</span> <span class="pre">1,</span> <span class="pre">20))</span></code></p>
</div></blockquote>
<p><strong>which</strong> : str, [‘LM’ | ‘SM’ | ‘LR’ | ‘SR’ | ‘LI’ | ‘SI’], optional</p>
<blockquote>
<div><p>Which <em class="xref py py-obj">k</em> eigenvectors and eigenvalues to find:</p>
<blockquote>
<div><p>‘LM’ : largest magnitude</p>
<p>‘SM’ : smallest magnitude</p>
<p>‘LR’ : largest real part</p>
<p>‘SR’ : smallest real part</p>
<p>‘LI’ : largest imaginary part</p>
<p>‘SI’ : smallest imaginary part</p>
</div></blockquote>
<p>When sigma != None, ‘which’ refers to the shifted eigenvalues w’[i]
(see discussion in ‘sigma’, above).  ARPACK is generally better
at finding large values than small values.  If small eigenvalues are
desired, consider using shift-invert mode for better performance.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int, optional</p>
<blockquote>
<div><p>Maximum number of Arnoldi update iterations allowed
Default: <code class="docutils literal"><span class="pre">n*10</span></code></p>
</div></blockquote>
<p><strong>tol</strong> : float, optional</p>
<blockquote>
<div><p>Relative accuracy for eigenvalues (stopping criterion)
The default value of 0 implies machine precision.</p>
</div></blockquote>
<p><strong>return_eigenvectors</strong> : bool, optional</p>
<blockquote>
<div><p>Return eigenvectors (True) in addition to eigenvalues</p>
</div></blockquote>
<p><strong>Minv</strong> : ndarray, sparse matrix or LinearOperator, optional</p>
<blockquote>
<div><p>See notes in M, above.</p>
</div></blockquote>
<p><strong>OPinv</strong> : ndarray, sparse matrix or LinearOperator, optional</p>
<blockquote>
<div><p>See notes in sigma, above.</p>
</div></blockquote>
<p><strong>OPpart</strong> : {‘r’ or ‘i’}, optional</p>
<blockquote>
<div><p>See notes in sigma, above</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>w</strong> : ndarray</p>
<blockquote>
<div><p>Array of k eigenvalues.</p>
</div></blockquote>
<p><strong>v</strong> : ndarray</p>
<blockquote>
<div><p>An array of <em class="xref py py-obj">k</em> eigenvectors.
<code class="docutils literal"><span class="pre">v[:,</span> <span class="pre">i]</span></code> is the eigenvector corresponding to the eigenvalue w[i].</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ArpackNoConvergence</strong></p>
<blockquote class="last">
<div><p>When the requested convergence is not obtained.
The currently converged eigenvalues and eigenvectors can be found
as <code class="docutils literal"><span class="pre">eigenvalues</span></code> and <code class="docutils literal"><span class="pre">eigenvectors</span></code> attributes of the exception
object.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="sisl.linalg.eigsh.html#sisl.linalg.eigsh" title="sisl.linalg.eigsh"><code class="xref py py-obj docutils literal"><span class="pre">eigsh</span></code></a></dt>
<dd>eigenvalues and eigenvectors for symmetric matrix A</dd>
<dt><code class="xref py py-obj docutils literal"><span class="pre">svds</span></code></dt>
<dd>singular value decomposition for a matrix A</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This function is a wrapper to the ARPACK <a class="reference internal" href="#r910" id="id1">[R910]</a> SNEUPD, DNEUPD, CNEUPD,
ZNEUPD, functions which use the Implicitly Restarted Arnoldi Method to
find the eigenvalues and eigenvectors <a class="reference internal" href="#r1010" id="id2">[R1010]</a>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r910" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R910]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id3">2</a>)</em> ARPACK Software, <a class="reference external" href="http://www.caam.rice.edu/software/ARPACK/">http://www.caam.rice.edu/software/ARPACK/</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r1010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R1010]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> R. B. Lehoucq, D. C. Sorensen, and C. Yang,  ARPACK USERS GUIDE:
Solution of Large Scale Eigenvalue Problems by Implicitly Restarted
Arnoldi Methods. SIAM, Philadelphia, PA, 1998.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Find 6 eigenvectors of the identity matrix:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="kn">as</span> <span class="nn">sparse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigs</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vals</span>
<span class="go">array([ 1.+0.j,  1.+0.j,  1.+0.j,  1.+0.j,  1.+0.j,  1.+0.j])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(13, 6)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, Nick R. Papior.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.9.2-166',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>